<div>
  <app-header-recepcionista></app-header-recepcionista>
</div>

<div class="container mt-4">
  <!-- Header con botón volver -->
  <div class="header">
    <div class="header-content">
      <button class="btn-back" (click)="volverALista()">
        <i class="fas fa-arrow-left"></i>
        Volver al Listado
      </button>
      <h1>
        <i class="fas fa-receipt me-2"></i>
        Detalles del Pago
      </h1>
      <p class="header-subtitle">Información completa del comprobante de pago</p>
    </div>
  </div>

  <!-- Loading -->
  <div *ngIf="cargando" class="loading-spinner">
    <div class="spinner"></div>
    <p>Cargando detalles del pago...</p>
    <div class="loading-dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>

  <!-- Error -->
  <div *ngIf="error && !cargando" class="error-container">
    <div class="error-content">
      <i class="fas fa-exclamation-triangle error-icon"></i>
      <div class="error-text">
        <h4>Error al cargar el pago</h4>
        <p>{{ error }}</p>
      </div>
      <button class="btn btn-primary" (click)="recargar()">
        <i class="fas fa-redo"></i> Reintentar
      </button>
    </div>
  </div>

  <!-- Detalles del pago -->
  <div *ngIf="pago && !cargando" class="details-content">
    <div class="row">
      <div class="col-lg-8">
        <!-- Comprobante -->
        <div class="card comprobante">
          <div class="card-header">
            <div class="d-flex justify-content-between align-items-center">
              <h4 class="mb-0">
                <i class="fas fa-receipt me-2"></i>
                Comprobante de Pago
              </h4>
              <span class="folio-badge">{{ folioComprobante }}</span>
            </div>
          </div>
          <div class="card-body">
            <!-- Información del gimnasio -->
            <div class="gym-info text-center mb-4">
              <h3 class="gym-name">Harmony Gym</h3>
              <p class="gym-subtitle">Sistema de Gestión de Pagos</p>
              <small class="gym-document">Comprobante de venta</small>
            </div>

            <div class="info-sections">
              <div class="info-section">
                <h6 class="section-title">
                  <i class="fas fa-info-circle me-2"></i>
                  INFORMACIÓN DEL PAGO
                </h6>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">ID Venta:</span>
                    <span class="info-value">#{{ pago.idVenta }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Fecha:</span>
                    <span class="info-value">{{ formatearFecha(pago.fechaVenta!) }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Folio:</span>
                    <span class="info-value">{{ folioComprobante }}</span>
                  </div>
                </div>
              </div>

              <div class="info-section">
                <h6 class="section-title">
                  <i class="fas fa-user me-2"></i>
                  INFORMACIÓN DEL CLIENTE
                </h6>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">Cliente:</span>
                    <span class="info-value">{{ obtenerNombreCliente(pago.folioCliente) }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Recepcionista:</span>
                    <span class="info-value">{{ obtenerNombreRecepcionista(pago.idRecepcionista) }}</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Detalles del producto -->
            <div class="product-details">
              <h6 class="section-title">
                <i class="fas fa-cube me-2"></i>
                DETALLES DEL PRODUCTO
              </h6>
              <div class="table-container">
                <table class="product-table">
                  <thead>
                    <tr>
                      <th>Producto/Membresía</th>
                      <th class="text-center">Cantidad</th>
                      <th class="text-end">Precio Unitario</th>
                      <th class="text-end">Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="product-info">
                          <span class="product-badge" [ngClass]="getBadgeClass(pago.codigoProducto)">
                            {{ getTipoProducto(pago.codigoProducto) }}
                          </span>
                          <span class="product-code">{{ obtenerNombreProducto(pago.codigoProducto) }}</span>
                        </div>
                      </td>
                      <td class="text-center">{{ pago.cantidad }}</td>
                      <td class="text-end">{{ formatearMoneda(pago.precioUnitario) }}</td>
                      <td class="text-end">{{ formatearMoneda(pago.total) }}</td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="3" class="text-end total-label">
                        <strong>Total:</strong>
                      </td>
                      <td class="text-end total-amount">
                        {{ formatearMoneda(pago.total) }}
                      </td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>

            <!-- Información adicional -->
            <div class="additional-info">
              <div class="info-note">
                <i class="fas fa-info-circle me-2"></i>
                Este comprobante es generado automáticamente por el sistema Harmony Gym.
                Para aclaraciones, presentar este documento en recepción.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <!-- Acciones -->
        <div class="card actions-card">
          <div class="card-header">
            <h6 class="mb-0">
              <i class="fas fa-cog me-2"></i>
              Acciones
            </h6>
          </div>
          <div class="card-body">
            <div class="actions-grid">
              <button class="btn btn-primary btn-action" (click)="imprimirComprobante()">
                <i class="fas fa-print"></i>
                Imprimir Comprobante
              </button>
              <button class="btn btn-secondary btn-action" (click)="volverALista()">
                <i class="fas fa-list"></i>
                Ver Todos los Pagos
              </button>
              <button class="btn btn-info btn-action" (click)="recargar()">
                <i class="fas fa-sync"></i>
                Actualizar
              </button>
            </div>
          </div>
        </div>

        <!-- Resumen -->
        <div class="card summary-card">
          <div class="card-header">
            <h6 class="mb-0">
              <i class="fas fa-info-circle me-2"></i>
              Resumen
            </h6>
          </div>
          <div class="card-body">
            <div class="summary-item">
              <span class="summary-label">Estado del Pago</span>
              <div class="summary-value status-completed">
                <i class="fas fa-check-circle"></i>
                COMPLETADO
              </div>
            </div>
            
            <div class="summary-item">
              <span class="summary-label">Tipo de Transacción</span>
              <div class="summary-value">
                <span class="transaction-badge" [ngClass]="getBadgeClass(pago.codigoProducto)">
                  {{ getTipoProducto(pago.codigoProducto) }}
                </span>
              </div>
            </div>

            <div class="summary-item">
              <span class="summary-label">Fecha de Registro</span>
              <div class="summary-value date-value">
                {{ formatearFecha(pago.fechaVenta!) }}
              </div>
            </div>

            <div class="summary-item">
              <span class="summary-label">Registrado por</span>
              <div class="summary-value">
                <span class="receptionist-badge">{{ pago.idRecepcionista }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>